#!/usr/bin/env bash

# parse background image filename and remove bash color sequences
bgfile="$1/$(wal --saturate 1 -i $1 | grep -E 'png|jpe?g' - | head -1 | awk '{ print $5; }' | sed 's/.$//' | sed -r 's/\x1B\[([0-9]{1,3}(;[0-9]{1,2})?)?[mGK]//g')"

echo "$bgfile" > /tmp/wallpaperfile

# https://github.com/FilipLitwora/pywal-discord
pywal-discord

launch_dunst

sleep 10
pgrep spotify && spicetify apply || spicetify update

#!/usr/bin/env bash

# make sure to install feh so pywal can use it to set the wallpaper

# parse background image filename and remove bash color sequences
bgfile="$1/$(wal --saturate 1 -i "$1" | grep -E 'png|jpe?g' - | head -1 | awk '{ print $5; }' | sed 's/.$//' | sed -r 's/\x1B\[([0-9]{1,3}(;[0-9]{1,2})?)?[mGK]//g')"

echo "$bgfile" > /tmp/wallpaperfile
